+ cd gnn
+ graphs=("star_graph_n4" "star_graph_n5" "star_graph_n6" "star_graph_n7")
+ joined_graphs_args='star_graph_n4 star_graph_n5 star_graph_n6 star_graph_n7'
+ epochs=50
+ batch_size=256
+ hidden_size=32
+ python lstm_scratch.py --program maximal_matching --epochs 50 --batch-size 256 --hidden-size 32 --num-layers 2 --graph-names star_graph_n4 star_graph_n5 star_graph_n6 star_graph_n7
Timestamp: 1751052121.739442 | Program: maximal_matching | Training with Graphs: star_graph_n4, star_graph_n5, star_graph_n6, star_graph_n7 | Batch size: 256 | Epochs: 50 | Hidden size: 32 | Num layers: 2.


Train dataset size: 71,248, Subset size: 200,000 | Test dataset size: 1,456


Model SimpleLSTM(
  (lstm): GRU(3, 32, num_layers=2, batch_first=True)
  (norm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
  (h2o): Linear(in_features=32, out_features=1, bias=True)
)
Total parameters: 9,985


Training set | Epoch: 1/50 | MSE Loss: 7.7263 | Time taken: 17.5981s
Training set | Epoch: 2/50 | MSE Loss: 1.281 | Time taken: 17.4805s
Training set | Epoch: 3/50 | MSE Loss: 0.4154 | Time taken: 17.5879s
Training set | Epoch: 4/50 | MSE Loss: 0.3644 | Time taken: 17.6566s
Training set | Epoch: 5/50 | MSE Loss: 0.2484 | Time taken: 17.6313s
Training set | Epoch: 6/50 | MSE Loss: 0.1803 | Time taken: 17.6354s
Training set | Epoch: 7/50 | MSE Loss: 0.1334 | Time taken: 17.6458s
Training set | Epoch: 8/50 | MSE Loss: 0.1094 | Time taken: 17.6211s
Training set | Epoch: 9/50 | MSE Loss: 0.1007 | Time taken: 17.6716s
Training set | Epoch: 10/50 | MSE Loss: 0.0925 | Time taken: 17.5695s
Training set | Epoch: 11/50 | MSE Loss: 0.0721 | Time taken: 17.5581s
Training set | Epoch: 12/50 | MSE Loss: 0.0817 | Time taken: 17.6339s
Training set | Epoch: 13/50 | MSE Loss: 0.0725 | Time taken: 17.7355s
Training set | Epoch: 14/50 | MSE Loss: 0.0747 | Time taken: 17.5482s
Training set | Epoch: 15/50 | MSE Loss: 0.0684 | Time taken: 17.5725s
Training set | Epoch: 16/50 | MSE Loss: 0.0763 | Time taken: 17.6192s
Training set | Epoch: 17/50 | MSE Loss: 0.0662 | Time taken: 17.5728s
Training set | Epoch: 18/50 | MSE Loss: 0.0575 | Time taken: 17.6004s
Training set | Epoch: 19/50 | MSE Loss: 0.0608 | Time taken: 17.5758s
Training set | Epoch: 20/50 | MSE Loss: 0.0531 | Time taken: 17.5742s
Training set | Epoch: 21/50 | MSE Loss: 0.0509 | Time taken: 17.5599s
Training set | Epoch: 22/50 | MSE Loss: 0.0486 | Time taken: 17.7479s
Training set | Epoch: 23/50 | MSE Loss: 0.0576 | Time taken: 17.5983s
Training set | Epoch: 24/50 | MSE Loss: 0.0499 | Time taken: 17.6002s
Training set | Epoch: 25/50 | MSE Loss: 0.0457 | Time taken: 17.5869s
Training set | Epoch: 26/50 | MSE Loss: 0.0474 | Time taken: 17.5179s
Training set | Epoch: 27/50 | MSE Loss: 0.0469 | Time taken: 17.5753s
Training set | Epoch: 28/50 | MSE Loss: 0.0422 | Time taken: 17.7113s
Training set | Epoch: 29/50 | MSE Loss: 0.0383 | Time taken: 17.7079s
Training set | Epoch: 30/50 | MSE Loss: 0.2165 | Time taken: 17.5816s
Training set | Epoch: 31/50 | MSE Loss: 0.0553 | Time taken: 17.5802s
Training set | Epoch: 32/50 | MSE Loss: 0.0461 | Time taken: 17.5683s
Training set | Epoch: 33/50 | MSE Loss: 0.0421 | Time taken: 17.6315s
Training set | Epoch: 34/50 | MSE Loss: 0.0335 | Time taken: 17.6497s
Training set | Epoch: 35/50 | MSE Loss: 0.0339 | Time taken: 17.6629s
Training set | Epoch: 36/50 | MSE Loss: 0.0329 | Time taken: 17.5819s
Training set | Epoch: 37/50 | MSE Loss: 0.0317 | Time taken: 17.5803s
Training set | Epoch: 38/50 | MSE Loss: 0.0282 | Time taken: 17.5263s
Training set | Epoch: 39/50 | MSE Loss: 0.0333 | Time taken: 17.5786s
Training set | Epoch: 40/50 | MSE Loss: 0.0254 | Time taken: 17.6084s
Training set | Epoch: 41/50 | MSE Loss: 0.0697 | Time taken: 17.5928s
Training set | Epoch: 42/50 | MSE Loss: 0.0243 | Time taken: 17.588s
Training set | Epoch: 43/50 | MSE Loss: 0.0226 | Time taken: 17.6312s
Training set | Epoch: 44/50 | MSE Loss: 0.0252 | Time taken: 17.6612s
Training set | Epoch: 45/50 | MSE Loss: 0.0249 | Time taken: 17.6102s
Training set | Epoch: 46/50 | MSE Loss: 0.0301 | Time taken: 17.6227s
Training set | Epoch: 47/50 | MSE Loss: 0.0253 | Time taken: 17.6071s
Training set | Epoch: 48/50 | MSE Loss: 0.0261 | Time taken: 17.6216s
Training set | Epoch: 49/50 | MSE Loss: 0.0285 | Time taken: 17.5844s
Training set | Epoch: 50/50 | MSE Loss: 0.0248 | Time taken: 17.4938s


End Training | Total training time taken 880.2597s


Saving model trained_models/lstm_trained_at_2025_06_27_13_36.pt


Testing model...
Test set | MSE loss: 0.0167 | Total matched: 1,441 out of 1,456 (Accuracy: 98.97%)
